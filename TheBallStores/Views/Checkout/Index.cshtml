@model TheBallStores.Models.KhachHang
@{
    ViewData["Title"] = "Xác nhận Đơn hàng";
    var cart = ViewBag.Cart as List<TheBallStores.Models.GioHangItem>;
    var tongTien = ViewBag.TongTien as decimal? ?? 0;
}

<h1 class="text-info mb-4">XÁC NHẬN ĐƠN HÀNG VÀ THANH TOÁN</h1>
<hr class="border-secondary" />

<div class="row g-4">
    <!-- CỘT 1: THÔNG TIN GIAO HÀNG & HÌNH THỨC TT -->
    <div class="col-md-6">
        <div class="card-vortex p-4">
            <h4 class="text-warning mb-3">THÔNG TIN GIAO HÀNG</h4>
            <p class="text-muted">Vui lòng xác nhận thông tin dưới đây là chính xác.</p>

            <form asp-action="Confirm" method="post">
                <!-- Mã Khách hàng là BẮT BUỘC -->
                <input type="hidden" name="MaKh" value="@Model.MaKh" />

                <!-- 1. Họ tên người nhận -->
                <div class="mb-3">
                    <label class="form-label text-white">Họ tên người nhận</label>
                    <input name="HoTen" class="form-control form-control-vortex" value="@(Model.HoTen ?? "")" required />
                </div>
                <!-- 2. Email (CHỈ ĐỌC) -->
                <div class="mb-3">
                    <label class="form-label text-white">Email</label>
                    <input name="Email" class="form-control form-control-vortex" value="@(Model.Email ?? "")" readonly />
                </div>
                <!-- 3. Số điện thoại -->
                <div class="mb-3">
                    <label class="form-label text-white">Số điện thoại</label>
                    <input name="DienThoai" class="form-control form-control-vortex" value="@(Model.DienThoai ?? "")" required />
                </div>
                <!-- 4. Địa chỉ giao hàng (ĐÃ SỬA TÊN INPUT) -->
                <div class="mb-4">
                    <label class="form-label text-white">Địa chỉ giao hàng</label>
                    <textarea name="DiaChiGiaoHang" class="form-control form-control-vortex" required>@(Model.DiaChi ?? "")</textarea>
                </div>

                <!-- HÌNH THỨC THANH TOÁN -->
                <h4 class="text-info mb-3 mt-4">HÌNH THỨC THANH TOÁN</h4>
                <div class="card-vortex p-3 mb-4">
                    <!-- COD (Thanh toán khi nhận hàng) -->
                    <div class="form-check mb-2">
                        <input class="form-check-input" type="radio" name="HinhThucThanhToan" id="paymentCod" value="COD" checked required>
                        <label class="form-check-label text-white" for="paymentCod">
                            Thanh toán khi nhận hàng (COD)
                        </label>
                    </div>
                    <!-- ONLINE (Chuyển khoản) -->
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="HinhThucThanhToan" id="paymentOnline" value="ONLINE" required>
                        <label class="form-check-label text-white" for="paymentOnline">
                            Chuyển khoản Ngân hàng (Online)
                        </label>
                    </div>
                </div>

                <button type="submit" class="btn btn-neon w-100 py-2">
                    <i class="bi bi-box-seam me-2"></i> XÁC NHẬN & ĐẶT HÀNG
                </button>
            </form>
        </div>
    </div>

    <!-- CỘT 2: CHI TIẾT ĐƠN HÀNG & TỔNG KẾT (Giữ nguyên) -->
    <div class="col-md-6">
        <div class="card-vortex p-4">
            <h4 class="text-info mb-3">CHI TIẾT ĐƠN HÀNG</h4>
            @if (cart != null)
            {
                @foreach (var item in cart)
                {
                    <div class="d-flex justify-content-between mb-2 pb-2 border-bottom border-secondary">
                        <span class="text-muted">@item.TenSp (@item.TenSize) x @item.SoLuong</span>
                        <span class="text-white">@item.ThanhTien.ToString("#,##0") đ</span>
                    </div>
                }
            }

            <h4 class="text-white mt-4 pt-3 border-top border-secondary">
                TỔNG TIỀN: <span class="text-success fw-bold float-end">@tongTien.ToString("#,##0") đ</span>
            </h4>

            <p class="text-warning mt-3">
                Xin cảm ơn sự tin tưởng của bạn!
            </p>
        </div>
    </div>
</div>