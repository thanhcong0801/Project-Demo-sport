@model IEnumerable<TheBallStores.Models.DonHang>

@{
    ViewData["Title"] = "Danh sách Đơn hàng";
    var totalOrders = Model.Count();
}

<h1 class="text-info mb-4">QUẢN LÝ ĐƠN HÀNG (@totalOrders)</h1>
<p class="text-muted">Các đơn hàng được đặt gần nhất.</p>
<hr class="border-secondary" />

<div class="mb-4">
    <a asp-controller="Admin" asp-action="Index" class="btn btn-secondary text-white">
        <i class="bi bi-arrow-left"></i> Về Dashboard
    </a>
</div>

<div class="card-vortex p-0 overflow-hidden">
    <table class="table table-dark table-striped table-hover mb-0">
        <thead>
            <tr class="text-warning">
                <th>Mã ĐH</th>
                <th>Ngày Đặt</th>
                <th>Khách Hàng</th>
                <th>Tổng Tiền</th>
                <th>Trạng Thái</th>
                <th>Thao tác</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var order in Model)
            {
                var trangThaiClass = order.TrangThai switch
                {
                    "Hoàn thành" => "bg-success",
                    "Đã hủy" => "bg-danger",
                    "Chờ thanh toán" => "bg-warning",
                    _ => "bg-info"
                };

                <tr>
                    <!-- Mã ĐH (Link xem chi tiết) -->
                    <td>
                        <a asp-controller="DonHangs" asp-action="Details" asp-route-id="@order.MaDonHang" class="text-info fw-bold">
                            #@order.MaDonHang
                        </a>
                    </td>

                    <td>@order.NgayDat?.ToString("dd/MM/yyyy HH:mm")</td>

                    <td>@(order.MaKhNavigation?.HoTen ?? "Khách vãng lai")</td>

                    <td class="text-success fw-bold">@(order.TongTien?.ToString("#,##0") ?? "0") đ</td>

                    <td>
                        <span class="badge @trangThaiClass">@order.TrangThai</span>
                    </td>

                    <td>
                        <a asp-controller="DonHangs" asp-action="Details" asp-route-id="@order.MaDonHang" class="btn btn-sm btn-primary">Xem</a>
                        <a href="#" class="btn btn-sm btn-danger disabled">Hủy</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>