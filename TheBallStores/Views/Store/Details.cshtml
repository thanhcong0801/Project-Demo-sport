@model TheBallStores.Models.SanPham
@{
    ViewData["Title"] = Model.TenSp;
}

<div class="container mt-5">
    <!-- Nút quay lại -->
    <a asp-action="Index" class="btn btn-outline-light mb-4">
        <i class="bi bi-arrow-left"></i> Quay lại Cửa hàng
    </a>

    <div class="row">
        <!-- CỘT TRÁI: ẢNH SẢN PHẨM -->
        <div class="col-md-6 mb-4">
            <div class="card-vortex p-3 text-center">
                @if (!string.IsNullOrEmpty(Model.AnhDaiDien))
                {
                    <img src="~/images/products/@Model.AnhDaiDien" class="img-fluid rounded"
                         style="max-height: 500px; width: 100%; object-fit: contain; filter: drop-shadow(0 0 30px rgba(102, 252, 241, 0.2));"
                         alt="@Model.TenSp">
                }
            </div>
        </div>

        <!-- CỘT PHẢI: THÔNG TIN & MUA HÀNG -->
        <div class="col-md-6">
            <h1 class="display-5 fw-bold text-white" style="text-shadow: 0 0 10px rgba(154, 52, 255, 0.5);">@Model.TenSp</h1>

            <div class="my-3">
                <span class="badge bg-info text-dark fs-6">@Model.MaLoaiNavigation?.TenLoai</span>
                <span class="text-white ms-3">Mã SP: #@Model.MaSp</span>
            </div>

            <h2 class="text-success fw-bold my-4" style="font-family: 'Chakra Petch';">
                @Model.GiaBan.ToString("#,##0") đ
            </h2>

            <p class="text-muted lead">
                @Model.MoTa ?? "Sản phẩm chất lượng cao từ Kicks Vortex. Thiết kế tối ưu cho hiệu suất thi đấu đỉnh cao."
            </p>

            <hr class="border-secondary my-4">

            <!-- FORM THÊM VÀO GIỎ -->
            <form asp-controller="GioHang" asp-action="ThemVaoGio" method="post">
                <input type="hidden" name="maSp" value="@Model.MaSp" />

                <!-- CHỌN SIZE -->
                <div class="mb-4">
                    <label class="form-label text-info fw-bold">CHỌN KÍCH THƯỚC (SIZE):</label>
                    <div class="d-flex flex-wrap gap-2">
                        @if (Model.SanPhamChiTiets != null && Model.SanPhamChiTiets.Any())
                        {
                            foreach (var item in Model.SanPhamChiTiets.OrderBy(x => x.MaSizeNavigation.TenSize))
                            {
                                // Chỉ hiện size còn hàng
                                if (item.SoLuongTon > 0)
                                {
                                    <input type="radio" class="btn-check" name="maSize" id="size_@item.MaSize" value="@item.MaSize" required>
                                    <label class="btn btn-outline-light px-3 py-2" for="size_@item.MaSize">
                                        @item.MaSizeNavigation.TenSize
                                    </label>
                                }
                            }
                        }
                        else
                        {
                            <div class="alert alert-danger bg-transparent text-danger border-danger">
                                <i class="bi bi-exclamation-triangle"></i> Sản phẩm này tạm hết hàng.
                            </div>
                        }
                    </div>
                </div>

                <!-- SỐ LƯỢNG & NÚT MUA -->
                <div class="d-flex align-items-center gap-3">
                    <div style="width: 100px;">
                        <input type="number" name="soLuong" class="form-control form-control-vortex text-center" value="1" min="1" max="10">
                    </div>

                    <button type="submit" class="btn btn-neon btn-lg flex-grow-1">
                        <i class="bi bi-cart-plus-fill me-2 text-white "></i> THÊM VÀO GIỎ
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>